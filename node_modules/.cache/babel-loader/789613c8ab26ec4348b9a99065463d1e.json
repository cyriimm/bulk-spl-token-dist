{"ast":null,"code":"var _jsxFileName = \"/Users/onyejivictor/Documents/code/cope/bulk-spl-token-dist/src/components/DepositDialog.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogForm from './DialogForm';\nimport { abbreviateAddress } from '../utils/utils';\nimport CopyableDisplay from './CopyableDisplay';\nimport { useSolanaExplorerUrlSuffix } from '../utils/connection';\nimport Typography from '@material-ui/core/Typography';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Button from '@material-ui/core/Button';\nimport { useAsyncData } from '../utils/fetch-loop';\nimport tuple from 'immutable-tuple';\nimport { useCallAsync } from '../utils/notifications';\nimport { ConnectToMetamaskButton, getErc20Balance, swapErc20ToSpl, useEthAccount, estimateErc20SwapFees } from '../utils/swap/eth';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Link from '@material-ui/core/Link';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport { DialogContentText, Tooltip } from '@material-ui/core';\nimport { EthFeeEstimate } from './EthFeeEstimate';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function DepositDialog({\n  open,\n  onClose,\n  publicKey,\n  balanceInfo,\n  swapInfo,\n  isAssociatedToken\n}) {\n  _s();\n\n  const ethAccount = useEthAccount();\n  const urlSuffix = useSolanaExplorerUrlSuffix();\n  const {\n    mint,\n    tokenName,\n    tokenSymbol,\n    owner\n  } = balanceInfo;\n  const [tab, setTab] = useState(0);\n  let tabs = null;\n\n  if (swapInfo) {\n    let firstTab = `SPL ${tokenSymbol !== null && tokenSymbol !== void 0 ? tokenSymbol : swapInfo.coin.ticker}`;\n    let secondTab = swapInfo.coin.ticker;\n\n    if (!mint) {\n      firstTab = 'SOL';\n    } else {\n      secondTab = `${swapInfo.coin.erc20Contract ? 'ERC20' : 'Native'} ${secondTab}`;\n    }\n\n    tabs = /*#__PURE__*/_jsxDEV(Tabs, {\n      value: tab,\n      variant: \"fullWidth\",\n      onChange: (e, value) => setTab(value),\n      textColor: \"primary\",\n      indicatorColor: \"primary\",\n      children: [/*#__PURE__*/_jsxDEV(Tab, {\n        label: firstTab\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Tab, {\n        label: secondTab\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this);\n  }\n\n  const displaySolAddress = publicKey.equals(owner) || isAssociatedToken;\n  const depositAddressStr = displaySolAddress ? owner.toBase58() : publicKey.toBase58();\n  return /*#__PURE__*/_jsxDEV(DialogForm, {\n    open: open,\n    onClose: onClose,\n    maxWidth: \"sm\",\n    fullWidth: true,\n    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n      children: [\"Deposit \", tokenName !== null && tokenName !== void 0 ? tokenName : mint.toBase58(), tokenSymbol ? ` (${tokenSymbol})` : null, ethAccount && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          color: \"textSecondary\",\n          style: {\n            fontSize: '14px'\n          },\n          children: [\"Metamask connected: \", ethAccount]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), tabs, /*#__PURE__*/_jsxDEV(DialogContent, {\n      style: {\n        paddingTop: 16\n      },\n      children: tab === 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [!displaySolAddress && isAssociatedToken === false ? /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"This address can only be used to receive\", ' ', tokenSymbol !== null && tokenSymbol !== void 0 ? tokenSymbol : abbreviateAddress(mint), \". Do not send SOL to this address.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: [\"This address can be used to receive\", ' ', tokenSymbol !== null && tokenSymbol !== void 0 ? tokenSymbol : abbreviateAddress(mint), \".\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(CopyableDisplay, {\n          value: depositAddressStr,\n          label: 'Deposit Address',\n          autoFocus: true,\n          qrCode: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n          variant: \"body2\",\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: `https://explorer.solana.com/account/${depositAddressStr}` + urlSuffix,\n            target: \"_blank\",\n            rel: \"noopener\",\n            children: \"View on Solana Explorer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(SolletSwapDepositAddress, {\n        balanceInfo: balanceInfo,\n        swapInfo: swapInfo,\n        ethAccount: ethAccount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        onClick: onClose,\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n\n_s(DepositDialog, \"0aHY84jFOb3yLDVLdLkjye+CeT4=\", false, function () {\n  return [useEthAccount, useSolanaExplorerUrlSuffix];\n});\n\n_c = DepositDialog;\n\nfunction SolletSwapDepositAddress({\n  balanceInfo,\n  swapInfo,\n  ethAccount\n}) {\n  _s2();\n\n  const [ethBalance] = useAsyncData(() => getErc20Balance(ethAccount), 'ethBalance', {\n    refreshInterval: 2000\n  });\n  const ethFeeData = useAsyncData(swapInfo.coin && (() => estimateErc20SwapFees({\n    erc20Address: swapInfo.coin.erc20Contract,\n    swapAddress: swapInfo.address,\n    ethAccount\n  })), 'depositEthFee', {\n    refreshInterval: 2000\n  });\n\n  if (!swapInfo) {\n    return null;\n  }\n\n  const ethFeeEstimate = Array.isArray(ethFeeData[0]) ? ethFeeData[0].reduce((acc, elem) => acc + elem) : ethFeeData[0];\n  const insufficientEthBalance = typeof ethBalance === 'number' && typeof ethFeeEstimate === 'number' && ethBalance < ethFeeEstimate;\n  const {\n    blockchain,\n    address,\n    memo,\n    coin\n  } = swapInfo;\n  const {\n    mint,\n    tokenName\n  } = balanceInfo;\n\n  if (blockchain === 'btc' && memo === null) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(DialogContentText, {\n        children: [\"Native BTC can be converted to SPL \", tokenName, \" by sending it to the following address:\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CopyableDisplay, {\n        value: address,\n        label: \"Native BTC Deposit Address\",\n        autoFocus: true,\n        qrCode: `bitcoin:${address}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  if (blockchain === 'eth') {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(DialogContentText, {\n        children: [coin.erc20Contract ? 'ERC20' : 'Native', \" \", coin.ticker, \" can be converted to \", mint ? 'SPL' : 'native', \" \", tokenName, \" via MetaMask. To convert, you must already have SOL in your wallet.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContentText, {\n        children: [\"Estimated withdrawal transaction fee:\", /*#__PURE__*/_jsxDEV(EthFeeEstimate, {\n          ethFeeData: ethFeeData,\n          insufficientEthBalance: insufficientEthBalance\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MetamaskDeposit, {\n        swapInfo: swapInfo,\n        insufficientEthBalance: insufficientEthBalance\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  return null;\n}\n\n_s2(SolletSwapDepositAddress, \"t7qUg36TH/xAiVlriaqfdr8WALM=\", false, function () {\n  return [useAsyncData, useAsyncData];\n});\n\n_c2 = SolletSwapDepositAddress;\n\nfunction MetamaskDeposit({\n  swapInfo,\n  insufficientEthBalance\n}) {\n  _s3();\n\n  const ethAccount = useEthAccount();\n  const [amount, setAmount] = useState('');\n  const [submitted, setSubmitted] = useState(false);\n  const [status, setStatus] = useState(null);\n  const callAsync = useCallAsync();\n  const {\n    address: swapAddress,\n    memo: destination,\n    coin: {\n      erc20Contract: erc20Address,\n      ticker\n    }\n  } = swapInfo;\n  const [maxAmount, maxAmountLoaded] = useAsyncData(async () => {\n    if (ethAccount) {\n      var _swapInfo$maxSize;\n\n      return Math.min(await getErc20Balance(ethAccount, erc20Address), (_swapInfo$maxSize = swapInfo.maxSize) !== null && _swapInfo$maxSize !== void 0 ? _swapInfo$maxSize : Infinity);\n    }\n\n    return 0;\n  }, tuple(getErc20Balance, ethAccount, erc20Address));\n\n  if (!ethAccount) {\n    return /*#__PURE__*/_jsxDEV(ConnectToMetamaskButton, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 12\n    }, this);\n  }\n\n  async function submit() {\n    setSubmitted(true);\n    setStatus({\n      step: 0\n    });\n    await callAsync((async () => {\n      let parsedAmount = parseFloat(amount);\n\n      if (!parsedAmount || parsedAmount > maxAmount || parsedAmount <= 0) {\n        throw new Error('Invalid amount');\n      }\n\n      await swapErc20ToSpl({\n        ethAccount,\n        erc20Address,\n        swapAddress,\n        destination,\n        amount,\n        onStatusChange: e => setStatus(status => ({ ...status,\n          ...e\n        }))\n      });\n    })(), {\n      onError: () => setSubmitted(false)\n    });\n  }\n\n  if (!submitted) {\n    let convertButton = /*#__PURE__*/_jsxDEV(Button, {\n      color: \"primary\",\n      style: {\n        marginLeft: 8\n      },\n      onClick: submit,\n      disabled: insufficientEthBalance,\n      children: \"Convert\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 7\n    }, this);\n\n    if (insufficientEthBalance) {\n      convertButton = /*#__PURE__*/_jsxDEV(Tooltip, {\n        title: \"Insufficient ETH for withdrawal transaction fee\",\n        placement: \"top\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: convertButton\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'baseline'\n      },\n      children: [/*#__PURE__*/_jsxDEV(TextField, {\n        label: \"Amount\",\n        fullWidth: true,\n        variant: \"outlined\",\n        margin: \"normal\",\n        type: \"number\",\n        InputProps: {\n          endAdornment: /*#__PURE__*/_jsxDEV(InputAdornment, {\n            position: \"end\",\n            children: ticker\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this),\n          inputProps: {\n            step: 'any'\n          }\n        },\n        value: amount,\n        onChange: e => setAmount(e.target.value.trim()),\n        helperText: maxAmountLoaded ? /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: () => setAmount(maxAmount.toFixed(6)),\n          children: [\"Max: \", maxAmount.toFixed(6)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 15\n        }, this) : null\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 9\n      }, this), convertButton]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 7\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Stepper, {\n      activeStep: status.step,\n      children: [/*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"Approve Conversion\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"Send Funds\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: \"Wait for Confirmations\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 7\n    }, this), status.step === 2 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginRight: 16\n          },\n          children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [status.confirms ? /*#__PURE__*/_jsxDEV(Typography, {\n            children: [status.confirms, \" / 12 Confirmations\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n            children: \"Transaction Pending\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body2\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              href: `https://etherscan.io/tx/${status.txid}`,\n              target: \"_blank\",\n              rel: \"noopener\",\n              children: \"View on Etherscan\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 11\n      }, this)\n    }, void 0, false) : null]\n  }, void 0, true);\n}\n\n_s3(MetamaskDeposit, \"TCPfyD7sRAqrNzzklByy2n+jyz8=\", false, function () {\n  return [useEthAccount, useCallAsync, useAsyncData];\n});\n\n_c3 = MetamaskDeposit;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"DepositDialog\");\n$RefreshReg$(_c2, \"SolletSwapDepositAddress\");\n$RefreshReg$(_c3, \"MetamaskDeposit\");","map":{"version":3,"sources":["/Users/onyejivictor/Documents/code/cope/bulk-spl-token-dist/src/components/DepositDialog.js"],"names":["React","useState","DialogTitle","DialogContent","DialogForm","abbreviateAddress","CopyableDisplay","useSolanaExplorerUrlSuffix","Typography","DialogActions","Button","useAsyncData","tuple","useCallAsync","ConnectToMetamaskButton","getErc20Balance","swapErc20ToSpl","useEthAccount","estimateErc20SwapFees","InputAdornment","TextField","Stepper","Step","StepLabel","CircularProgress","Link","Tabs","Tab","DialogContentText","Tooltip","EthFeeEstimate","DepositDialog","open","onClose","publicKey","balanceInfo","swapInfo","isAssociatedToken","ethAccount","urlSuffix","mint","tokenName","tokenSymbol","owner","tab","setTab","tabs","firstTab","coin","ticker","secondTab","erc20Contract","e","value","displaySolAddress","equals","depositAddressStr","toBase58","fontSize","paddingTop","SolletSwapDepositAddress","ethBalance","refreshInterval","ethFeeData","erc20Address","swapAddress","address","ethFeeEstimate","Array","isArray","reduce","acc","elem","insufficientEthBalance","blockchain","memo","MetamaskDeposit","amount","setAmount","submitted","setSubmitted","status","setStatus","callAsync","destination","maxAmount","maxAmountLoaded","Math","min","maxSize","Infinity","submit","step","parsedAmount","parseFloat","Error","onStatusChange","onError","convertButton","marginLeft","display","alignItems","endAdornment","inputProps","target","trim","toFixed","justifyContent","marginRight","confirms","txid"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogForm from './DialogForm';\nimport { abbreviateAddress } from '../utils/utils';\nimport CopyableDisplay from './CopyableDisplay';\nimport { useSolanaExplorerUrlSuffix } from '../utils/connection';\nimport Typography from '@material-ui/core/Typography';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Button from '@material-ui/core/Button';\nimport { useAsyncData } from '../utils/fetch-loop';\nimport tuple from 'immutable-tuple';\nimport { useCallAsync } from '../utils/notifications';\nimport {\n  ConnectToMetamaskButton,\n  getErc20Balance,\n  swapErc20ToSpl,\n  useEthAccount,\n  estimateErc20SwapFees,\n} from '../utils/swap/eth';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Link from '@material-ui/core/Link';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport { DialogContentText, Tooltip } from '@material-ui/core';\nimport { EthFeeEstimate } from './EthFeeEstimate';\n\nexport default function DepositDialog({\n  open,\n  onClose,\n  publicKey,\n  balanceInfo,\n  swapInfo,\n  isAssociatedToken,\n}) {\n  const ethAccount = useEthAccount();\n  const urlSuffix = useSolanaExplorerUrlSuffix();\n  const { mint, tokenName, tokenSymbol, owner } = balanceInfo;\n  const [tab, setTab] = useState(0);\n\n  let tabs = null;\n  if (swapInfo) {\n    let firstTab = `SPL ${tokenSymbol ?? swapInfo.coin.ticker}`;\n    let secondTab = swapInfo.coin.ticker;\n    if (!mint) {\n      firstTab = 'SOL';\n    } else {\n      secondTab = `${\n        swapInfo.coin.erc20Contract ? 'ERC20' : 'Native'\n      } ${secondTab}`;\n    }\n    tabs = (\n      <Tabs\n        value={tab}\n        variant=\"fullWidth\"\n        onChange={(e, value) => setTab(value)}\n        textColor=\"primary\"\n        indicatorColor=\"primary\"\n      >\n        <Tab label={firstTab} />\n        <Tab label={secondTab} />\n      </Tabs>\n    );\n  }\n  const displaySolAddress = publicKey.equals(owner) || isAssociatedToken;\n  const depositAddressStr = displaySolAddress\n    ? owner.toBase58()\n    : publicKey.toBase58();\n  return (\n    <DialogForm open={open} onClose={onClose} maxWidth=\"sm\" fullWidth>\n      <DialogTitle>\n        Deposit {tokenName ?? mint.toBase58()}\n        {tokenSymbol ? ` (${tokenSymbol})` : null}\n        {ethAccount && (\n          <div>\n            <Typography color=\"textSecondary\" style={{ fontSize: '14px' }}>\n              Metamask connected: {ethAccount}\n            </Typography>\n          </div>\n        )}\n      </DialogTitle>\n      {tabs}\n      <DialogContent style={{ paddingTop: 16 }}>\n        {tab === 0 ? (\n          <>\n            {!displaySolAddress && isAssociatedToken === false ? (\n              <DialogContentText>\n                This address can only be used to receive{' '}\n                {tokenSymbol ?? abbreviateAddress(mint)}. Do not send SOL to\n                this address.\n              </DialogContentText>\n            ) : (\n              <DialogContentText>\n                This address can be used to receive{' '}\n                {tokenSymbol ?? abbreviateAddress(mint)}.\n              </DialogContentText>\n            )}\n            <CopyableDisplay\n              value={depositAddressStr}\n              label={'Deposit Address'}\n              autoFocus\n              qrCode\n            />\n            <DialogContentText variant=\"body2\">\n              <Link\n                href={\n                  `https://explorer.solana.com/account/${depositAddressStr}` +\n                  urlSuffix\n                }\n                target=\"_blank\"\n                rel=\"noopener\"\n              >\n                View on Solana Explorer\n              </Link>\n            </DialogContentText>\n          </>\n        ) : (\n          <SolletSwapDepositAddress\n            balanceInfo={balanceInfo}\n            swapInfo={swapInfo}\n            ethAccount={ethAccount}\n          />\n        )}\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Close</Button>\n      </DialogActions>\n    </DialogForm>\n  );\n}\n\nfunction SolletSwapDepositAddress({ balanceInfo, swapInfo, ethAccount }) {\n  const [ethBalance] = useAsyncData(\n    () => getErc20Balance(ethAccount),\n    'ethBalance',\n    {\n      refreshInterval: 2000,\n    },\n  );\n\n  const ethFeeData = useAsyncData(\n    swapInfo.coin &&\n      (() =>\n        estimateErc20SwapFees({\n          erc20Address: swapInfo.coin.erc20Contract,\n          swapAddress: swapInfo.address,\n          ethAccount,\n        })),\n    'depositEthFee',\n    {\n      refreshInterval: 2000,\n    },\n  );\n\n  if (!swapInfo) {\n    return null;\n  }\n\n  const ethFeeEstimate = Array.isArray(ethFeeData[0])\n    ? ethFeeData[0].reduce((acc, elem) => acc + elem)\n    : ethFeeData[0];\n  const insufficientEthBalance =\n    typeof ethBalance === 'number' &&\n    typeof ethFeeEstimate === 'number' &&\n    ethBalance < ethFeeEstimate;\n\n  const { blockchain, address, memo, coin } = swapInfo;\n  const { mint, tokenName } = balanceInfo;\n\n  if (blockchain === 'btc' && memo === null) {\n    return (\n      <>\n        <DialogContentText>\n          Native BTC can be converted to SPL {tokenName} by sending it to the\n          following address:\n        </DialogContentText>\n        <CopyableDisplay\n          value={address}\n          label=\"Native BTC Deposit Address\"\n          autoFocus\n          qrCode={`bitcoin:${address}`}\n        />\n      </>\n    );\n  }\n\n  if (blockchain === 'eth') {\n    return (\n      <>\n        <DialogContentText>\n          {coin.erc20Contract ? 'ERC20' : 'Native'} {coin.ticker} can be\n          converted to {mint ? 'SPL' : 'native'} {tokenName} via MetaMask. To\n          convert, you must already have SOL in your wallet.\n        </DialogContentText>\n        <DialogContentText>\n          Estimated withdrawal transaction fee:\n          <EthFeeEstimate\n            ethFeeData={ethFeeData}\n            insufficientEthBalance={insufficientEthBalance}\n          />\n        </DialogContentText>\n        <MetamaskDeposit\n          swapInfo={swapInfo}\n          insufficientEthBalance={insufficientEthBalance}\n        />\n      </>\n    );\n  }\n\n  return null;\n}\n\nfunction MetamaskDeposit({ swapInfo, insufficientEthBalance }) {\n  const ethAccount = useEthAccount();\n  const [amount, setAmount] = useState('');\n  const [submitted, setSubmitted] = useState(false);\n  const [status, setStatus] = useState(null);\n  const callAsync = useCallAsync();\n\n  const {\n    address: swapAddress,\n    memo: destination,\n    coin: { erc20Contract: erc20Address, ticker },\n  } = swapInfo;\n\n  const [maxAmount, maxAmountLoaded] = useAsyncData(async () => {\n    if (ethAccount) {\n      return Math.min(\n        await getErc20Balance(ethAccount, erc20Address),\n        swapInfo.maxSize ?? Infinity,\n      );\n    }\n    return 0;\n  }, tuple(getErc20Balance, ethAccount, erc20Address));\n\n  if (!ethAccount) {\n    return <ConnectToMetamaskButton />;\n  }\n\n  async function submit() {\n    setSubmitted(true);\n    setStatus({ step: 0 });\n    await callAsync(\n      (async () => {\n        let parsedAmount = parseFloat(amount);\n\n        if (!parsedAmount || parsedAmount > maxAmount || parsedAmount <= 0) {\n          throw new Error('Invalid amount');\n        }\n        await swapErc20ToSpl({\n          ethAccount,\n          erc20Address,\n          swapAddress,\n          destination,\n          amount,\n          onStatusChange: (e) => setStatus((status) => ({ ...status, ...e })),\n        });\n      })(),\n      { onError: () => setSubmitted(false) },\n    );\n  }\n\n  if (!submitted) {\n    let convertButton = (\n      <Button\n        color=\"primary\"\n        style={{ marginLeft: 8 }}\n        onClick={submit}\n        disabled={insufficientEthBalance}\n      >\n        Convert\n      </Button>\n    );\n\n    if (insufficientEthBalance) {\n      convertButton = (\n        <Tooltip\n          title=\"Insufficient ETH for withdrawal transaction fee\"\n          placement=\"top\"\n        >\n          <span>{convertButton}</span>\n        </Tooltip>\n      );\n    }\n\n    return (\n      <div style={{ display: 'flex', alignItems: 'baseline' }}>\n        <TextField\n          label=\"Amount\"\n          fullWidth\n          variant=\"outlined\"\n          margin=\"normal\"\n          type=\"number\"\n          InputProps={{\n            endAdornment: (\n              <InputAdornment position=\"end\">{ticker}</InputAdornment>\n            ),\n            inputProps: {\n              step: 'any',\n            },\n          }}\n          value={amount}\n          onChange={(e) => setAmount(e.target.value.trim())}\n          helperText={\n            maxAmountLoaded ? (\n              <span onClick={() => setAmount(maxAmount.toFixed(6))}>\n                Max: {maxAmount.toFixed(6)}\n              </span>\n            ) : null\n          }\n        />\n        {convertButton}\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <Stepper activeStep={status.step}>\n        <Step>\n          <StepLabel>Approve Conversion</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>Send Funds</StepLabel>\n        </Step>\n        <Step>\n          <StepLabel>Wait for Confirmations</StepLabel>\n        </Step>\n      </Stepper>\n      {status.step === 2 ? (\n        <>\n          <div\n            style={{\n              display: 'flex',\n              justifyContent: 'center',\n              alignItems: 'center',\n            }}\n          >\n            <div style={{ marginRight: 16 }}>\n              <CircularProgress />\n            </div>\n            <div>\n              {status.confirms ? (\n                <Typography>{status.confirms} / 12 Confirmations</Typography>\n              ) : (\n                <Typography>Transaction Pending</Typography>\n              )}\n              <Typography variant=\"body2\">\n                <Link\n                  href={`https://etherscan.io/tx/${status.txid}`}\n                  target=\"_blank\"\n                  rel=\"noopener\"\n                >\n                  View on Etherscan\n                </Link>\n              </Typography>\n            </div>\n          </div>\n        </>\n      ) : null}\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}